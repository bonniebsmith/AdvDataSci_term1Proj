---
title: "Statistical techniques used for work published in the Public Library of Science"
author: "Bonnie Smith"
date: "October 11, 2017"
output:
  html_document: default
  pdf_document: default
subtitle: Class project for Advanced Data Science I
---

### Introduction ###

The Public Library of Science (PLoS) is a collection of open-access journals representing a variety of sub-fields with connections to biology.  The discipline-specific journals in the collection are PLoS Biology, PLoS Medicine, PLoS Computational Biology, PLoS Genetics, PLoS Pathogens, and PLoS Neglected Tropical Diseases.  The inception of these six journals ranges from October 2003 (PLos Biology) to October 2007 (PLoS Neglected Tropical Diseases).  Note that there is also a catch-all journal, PLoS ONE, which we shall ignore for the purpose of this analysis.

In this project, we examine the statistical techniques used in research articles published in the six discipline-specific PLoS journals.  We identify common techniques, and whether they vary by journal and year of publication date.  Specifically, we address two questions of interest:  

   1.  Out of a list of statistical techniques used in PLoS articles (which we formulate as discussed below), identify the 5 most widely used in each discipline in 2016, and the 5 most widely used in each disipline in 2010.  
   
   2.  Group a subset of statistical techniques into 4 groups by theme, and examine the popularity of each group in each year from 2010 to 2016.  Identify disciplines where the change over time is greatest and least.

### Methods ###

Using the `rplos` package, which allows us to interface with the PLoS API directly in R, we search the library of PLoS papers for certain keywords, comprising our statistical techniques of interest.  Identification of this list of keywords is discussed below.  We restrict our search to full-length 'research articles' only (as opposed to 'viewpoints', 'correspondence', etc.);  the following table gives the number of full-length research articles that have appeared in each journal to date.  

```{r numbers by journal,echo=FALSE}

library(rplos)

num_path=searchplos(q="*:*", fl="publication_date",
      fq=list('journal:"PLoS Pathogens"', 'doc_type:full', 'article_type:"Research Article"'))$meta$numFound

num_gen=searchplos(q="*:*", fl="journal",
      fq=list('journal:"PLoS Genetics"', 'doc_type:full', 'article_type:"Research Article"'))$meta$numFound

num_bio=searchplos(q="*:*", fl="journal",
      fq=list('journal:"PLoS Biology"', 'doc_type:full', 'article_type:"Research Article"'))$meta$numFound

num_comp_bio=searchplos(q="*:*", fl="publication_date",
      fq=list('journal:"PLoS Computational Biology"', 'doc_type:full', 'article_type:"Research Article"'))$meta$numFound

num_trop=searchplos(q="*:*", fl="journal",
      fq=list('journal:"PLoS Neglected Tropical Diseases"', 'doc_type:full', 'article_type:"Research Article"'))$meta$numFound

num_med=searchplos(q="*:*", fl="journal",
      fq=list('journal:"PLoS Medicine"', 'doc_type:full', 'article_type:"Research Article"'))$meta$numFound

library(knitr)

x=matrix(c(num_bio, num_med, num_comp_bio, num_gen, num_path, num_trop),nrow=1)

kable(x,col.names=c("PLos Bio","PLoS Medicine", "PLoS Comp. Bio.","PLoS Genetics","PLoS Pathogens","PLoS Trop. Diseases"),caption="Total number of research articles that have appeared in each PLoS journal")

```

We further restrict our search to the "Materials and Methods" section of the articles, and stratify the results both by journal and by year of publication. 




In order to form our list of keywords to search, we take a random sample of 100 PLoS articles, which is representative of all PLoS research articles in terms of journal and time period.  We read in the 'Materials and Methods' sections of the articles in our sample, check each by hand, and add any statistical methods mentioned to our list of keywords.  This list has been refined slightly and roughly organized into categories below.

**List of Keywords: **

   * **ANOVA**.  **Chi-square**.  **Fisher's exact test**. **T test**. 

   * **Kaplan-Meier**.  **Cox** proportional hazard/Cox regression.  

   * **Wilcoxon** rank-sum test/Mann-Whitney U-test.  **Nonparametric**.

   * **Cross validation**.  **Machine learning**.  **Lasso** regression.  Lowess.  Kernel density.  Penalized spline regression.

   * K-means **clustering**/ hierarchical clustering.  Singular value decomposition/**principal components**.

   * **Linear regression**.  **Logistic regression**.  Generalized linear models /Poisson regression.  Likelihood ratio test.  Mixed-effect model/**random-effect model**/linear mixed model.  **Generalized estimating equations**.

   * **Simulations**.  **Bootstrap**.  

   * **Markov chain Monte Carlo**.  Multiple imputation.  Hidden Markov model.  **Empirical Bayes**.  **Bayesian**.
   
   
In order to examine trends across journal and accross years, for each keyword, for each of 4 journals, we compute the proportion of the journal's research articles from 2009 and 2010 which contain that keyword.  We then do the same for 2016-2017.  Results are displayed below.

### Results and Discussion

```{r  list, echo=FALSE, message=FALSE}

library(stringr)
library(rebus)



### list of search terms

my_list=c('materials_and_methods:ANOVA','materials_and_methods:"t test"','materials_and_methods:"chi square"','materials_and_methods:"Fisher exact test"','materials_and_methods:Wilcoxon', 'materials_and_methods:"linear regression"','materials_and_methods:"logistic regression"','materials_and_methods:"Kaplan-Meier"','materials_and_methods:Cox','materials_and_methods:"generalized estimating equation"','materials_and_methods:"random effect model"', 'materials_and_methods:"cross validation"', 'materials_and_methods:"machine learning"', 'materials_and_methods:lasso','materials_and_methods:clustering','materials_and_methods:"principal components"',   'materials_and_methods:simulation', 'materials_and_methods:bootstrap', 'materials_and_methods:"Markov chain Monte Carlo"', 'materials_and_methods:"empirical Bayes"','materials_and_methods:Bayesian',  'materials_and_methods:nonparametric','materials_and_methods:*')

#my_list

N=length(my_list)

```

```{r bio counts,echo=FALSE,eval=FALSE}

bio_searches=lapply(my_list,function(x) searchplos(x,fl="publication_date",
      fq= list('doc_type:full', 'article_type:"Research Article"',
               'journal:"PLoS Biology"'),limit=2400 ) )

bio_words_2010=vector(length=N)
for(n in 1:N){
      bio_words_2010[n]=sum(str_count(bio_searches[n],pattern=or("2009","2010")))
}

round(bio_words_2010/bio_words_2010[N],3)

bio_words_2016=vector(length=N)
for(n in 1:N){
      bio_words_2016[n]=sum(str_count(bio_searches[n],pattern=or("2016","2017")))
}

round(bio_words_2016/bio_words_2016[N],3)

```

```{r comp bio counts,echo=FALSE,eval=FALSE}

cb_searches=lapply(my_list, function(x) searchplos(x,fl="publication_date",
      fq= list('doc_type:full', 'article_type:"Research Article"',
               'journal:"PLoS Computational Biology"'),limit=4750 ))

cb_words_2010=vector(length=N)
for(n in 1:N){
      cb_words_2010[n]=sum(str_count(cb_searches[n],pattern=or("2010","2009")))
}

round(cb_words_2010/cb_words_2010[N],3)

cb_words_2016=vector(length=N)
for(n in 1:N){
      cb_words_2016[n]=sum(str_count(cb_searches[n],pattern=or("2016","2017")))
}

round(cb_words_2016/cb_words_2016[N],3)

```

```{r gen counts,echo=FALSE,eval=FALSE}

gen_searches=lapply(my_list,function(x) searchplos(x,fl="publication_date",
      fq= list('doc_type:full', 'article_type:"Research Article"',
               'journal:"PLoS Genetics"'),limit=6200 ))

gen_words_2010=vector(length=N)
for(n in 1:N){
      gen_words_2010[n]=sum(str_count(gen_searches[n][[1]]$data,pattern=or("2010","2009")))
}

round(gen_words_2010/gen_words_2010[N],3)

gen_words_2016=vector(length=N)
for(n in 1:N){
      gen_words_2016[n]=sum(str_count(gen_searches[n][[1]]$data,pattern=or("2016","2017")))
}

round(gen_words_2016/gen_words_2016[N],3)

```

```{r medicine counts,echo=FALSE,eval=FALSE}

med_searches=lapply(my_list,function(x) searchplos(x,fl="publication_date",
      fq= list('doc_type:full', 'article_type:"Research Article"',
               'journal:"PLoS Medicine"'),limit=1400 ))

med_words_2010=vector(length=N)
for(n in 1:N){
      med_words_2010[n]=sum(str_count(med_searches[n],pattern=or("2010","2009")))
}

round(med_words_2010/med_words_2010[N],3)

med_words_2016=vector(length=N)
for(n in 1:N){
      med_words_2016[n]=sum(str_count(med_searches[n],pattern=or("2016","2017")))
}

round(med_words_2016/med_words_2016[N],3)

```


```{r table,echo=FALSE}

prop_bio_2010=c(.169,.614,.029,.029,.042,.050,.016,.024,.008,.000,.003,.019,.003,.008,.151,.029,.143,.058,.005,.003,.048,.032,1.000)

prop_bio_2016=c(.269,.756,.063,.026,.085,.089,.030,.015,.022,.004,.000,.055,.004,.004,.262,.018,.210,.092,.018,.004,.063,.063,1.000)

prop_cb_2010=c(.027,.482,.017,.027,.027,.043,.010,.000,.000,.000,.004,.074,.032,.003,.261,.052,.553,.065,.014,.004,.082,.017,1.000)

prop_cb_2016=c(.046,.531,.018,.017,.028,.062,.029,.005,.011,.000,.002,.100,.043,.030,.238,.057,.633,.072,.030,.006,.109,.014,1.000)

prop_gen_2010=c(.083,.692,.082,.059,.035,.080,.054,.016,.023,.006,.006,.014,.003,.002,.200,.041,.109,.080,.015,.011,.065,.012,1.000)

prop_gen_2016=c(.165,.739,.068,.079,.049,.078,.044,.024,.033,.001,.005,.017,.002,.005,.199,.085,.092,.066,.006,.007,.034,.010,1.000)

prop_med_2010=c(.044,.844,.231,.094,.075,.038,.262,.106,.144,.038,.069,.031,.000,.006,.181,.019,.188,.075,.050,.0000,.088,.069,1.000)

prop_med_2016=c(.063,.830,.137,.089,.056,.181,.267,.093,.196,.015,.052,.026,.000,.007,.263,.070,.107,.096,.019,.004,.063,.033,1.000)

word_table=data.frame(prop_bio_2010, prop_bio_2016, prop_cb_2010, prop_cb_2016, prop_gen_2010, prop_gen_2016, prop_med_2010, prop_med_2016)

row.names(word_table)=c("ANOVA","t test","chi square", "Fisher exact test","Wilcoxon", "linear regression", "logistic regression", "Kaplan-Meier", "Cox","generalized estimating equation", "random effect model", "cross validation", "machine learning","lasso", "clustering","principal components", "simulation", "bootstrap", "Markov chain Monte Carlo", "empirical Bayes", "Bayesian", "nonparametric","(any word)")

colnames(word_table)=c("Biology, 2009-10", "Biology, 2016-17", "Comp. Bio., 2009-2010", "Comp. Bio., 2016-17", "Genetics, 2009-10", "Genetics, 2016-17", "Medicine, 2009-10", "Medicine, 2016-17")

kable(word_table,caption="Proportion of a journal's research articles containing the keyword, in 2009-2010 vs. 2016-2017")

```


